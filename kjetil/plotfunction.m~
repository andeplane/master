
clc
clear all;
load mesh.mat;
close all
fclose all;

for i = 0:1:1
   
[points, connectivity, offsets, u] = read_vtk(sprintf('output/v_'));
[~,~,~, p] = read_vtk('output/p_' num2str(i) '000000.vtu');

% fileID = fopen('output/mesh_0000000.vtu');
% formatSpec = '%s';
% N = 100;
% C_text = textscan(fileID, formatSpec, N, 'delimiter', '\n','bufsize',1e9);
% C = C_text{1};
% C = [C(6);C(9);C(10);C(11)];
%    %Read data from file (old):
%    u = load(['output/v_' num2str(i) '.txt']);
%    p = load(['output/p_' num2str(i) '.txt']);
%    ind = load(['output/mesh_' num2str(i) '.txt']);
%    coord = load(['output/pos_' num2str(i) '.txt']);
%    Elem2Node = reshape(ind,size(Elem2Node,1),size(Elem2Node,2))+1;
%    gcoord = reshape(coord,size(gcoord,1),size(gcoord,2));
%    vx = u(1:length(u)/2);
%    vy = u(length(u)/2+1:end);

    %Plot
    figure(1)
    hold off
    % plot3(gcoord(1,:),gcoord(2,:),vy,'.')
    trisurf(Elem2Node',gcoord(1,:),gcoord(2,:),p)
    axis equal
    grid off
    shading interp;
    set(gcf,'renderer', 'zbuffer')
    view(2)
    %set(gca,'clim',[0 0.15])
    colorbar
    hold on
    quiver3(gcoord(1,I),gcoord(2,I),gcoord(1,:)*0+10, vx, vy, vy*0,'k');
    hold off
    drawnow
end